(function(){var SHORTCUTS={};var KEY_STREAM=[];var MAX_LENGTH=0;var resetTimerId=0;var nonCharacterKeyPressed=false;var $document=jQuery(document);jQuery.event.special.shortcut={setup:function(){$document.bind("keydown",keydown);$document.bind("aui:keypress",keypress);$document.bind("keyup",keyup)},teardown:function(){$document.unbind("keydown",keydown);$document.unbind("aui:keypress",keypress);$document.unbind("keyup",keyup)},add:function(config){if(this!==document){throw new TypeError('"shortcut" event handlers must be bound at the document')}if(config.data===undefined){throw new Error('No data argument supplied in call to jQuery.fn.bind("shortcut", '+(config.handler.name||"function")+")")}if(typeof config.data!=="string"){throw new TypeError("Object "+config.data+" is not a string")}if(config.data.length===0){throw new Error("Shortcut sequence must not be empty")}for(var shortcut in SHORTCUTS){if(hasConflict(shortcut,config.data)){console.log('Cannot bind new shortcut "'+config.data+'" due to conflict with existing shortcut "'+shortcut+'"');return }}if(config.data.length>MAX_LENGTH){MAX_LENGTH=config.data.length}SHORTCUTS[config.data]=config.handler},remove:function(config){if(this!==document){throw new TypeError('"shortcut" event handlers must be bound at the document')}delete SHORTCUTS[config.data]}};function keydown(event){if(nonCharacterKeyPressed){resetKeyStream()}nonCharacterKeyPressed=(event.which!==16)}function keypress(event){if(jQuery(event.target).is(":input:not(button[type=button])")){resetKeyStream();return }KEY_STREAM.push(event.key);clearTimeout(resetTimerId);resetTimerId=setTimeout(resetKeyStream,2000);if(KEY_STREAM.length>MAX_LENGTH){KEY_STREAM.shift()}var keyStream=KEY_STREAM.join("");for(var i=0;i<keyStream.length;i++){var shortcut=keyStream.slice(i);if(shortcut in SHORTCUTS){event.preventDefault();event=new jQuery.Event("shortcut");event.data=shortcut;SHORTCUTS[shortcut].call(document,event);KEY_STREAM.length=0;break}}nonCharacterKeyPressed=false}function keyup(){if(nonCharacterKeyPressed){resetKeyStream()}}function resetKeyStream(){KEY_STREAM.length=0}function hasConflict(shortcut1,shortcut2){var len1=shortcut1.length;var len2=shortcut2.length;if(len1===len2){return shortcut1===shortcut2}var i,d;if(len1<len2){i=shortcut2.indexOf(shortcut1);d=len2-len1}else{i=shortcut1.indexOf(shortcut2);d=len1-len2}return i>=0&&i<d}})();