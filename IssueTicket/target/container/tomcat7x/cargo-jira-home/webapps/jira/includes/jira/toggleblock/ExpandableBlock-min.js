JIRA.ExpandableBlock={};JIRA.ExpandableBlock.init=(function(){return function(opts){var CONST={containerSelector:"li.expando",linkSelector:".versionBanner-link",contentClass:"versionBanner-content",activeClass:"active",tweenSpeed:"fast",requestParams:"decorator=none&contentOnly=true&noTitle=true",collapseVersionParam:"collapseVersion",expandVersionParam:"expandVersion",tabSelector:JIRA.Page.mainContentCssSelector,activeTabSelector:"#user_profile_tabs li.active"};AJS.$.extend(CONST,opts);var handler=(function(){jQuery(CONST.tabSelector).find(".versionBanner-header").click(function(e){var parent=jQuery(this).parent(),contentElement=parent.find("."+CONST.contentClass),linkTarget=jQuery(this).find(CONST.linkSelector);if(e.target.nodeName==="A"||jQuery(e.target).parent().get(0).nodeName==="A"){return }if(!parent.hasClass(CONST.activeClass)&&!contentElement.is(":animated")){parent.addClass(CONST.activeClass);jQuery(jQuery.ajax({url:linkTarget.attr("href"),data:CONST.requestParams,dataType:"html",success:function(response){if(contentElement.length===0){contentElement=jQuery("<div>").css({display:"block",overflow:"hidden",height:"0"}).addClass(CONST.contentClass).appendTo(parent).click(function(e){e.stopPropagation()})}contentElement.html(response);contentElement.css({display:"block",overflow:"hidden"}).animate({height:contentElement.prop("scrollHeight")},CONST.tweenSpeed,function(){linkTarget.attr("href",linkTarget.attr("href").replace(CONST.expandVersionParam,CONST.collapseVersionParam));parent.addClass("expanded")})},error:function(XMLHttpRequest,textStatus,errorThrown){var url=linkTarget.attr("href");window.location.href=url.replace(/\?.*/,"")}})).throbber({target:jQuery(CONST.activeTabSelector)})}else{if(parent.hasClass(CONST.activeClass)&&!parent.hasClass("locked")){jQuery.get(linkTarget.attr("href")+"&"+CONST.requestParams,function(){parent.removeClass(CONST.activeClass);contentElement.css({overflow:"hidden"}).animate({height:0},CONST.tweenSpeed,function(){contentElement.css({display:"none"});linkTarget.attr("href",linkTarget.attr("href").replace(CONST.collapseVersionParam,CONST.expandVersionParam));parent.removeClass("expanded")})})}}});return arguments.callee})()}})();AJS.namespace("jira.util.expandoSupport",null,JIRA.ExpandableBlock.init);