define("jira/ajs/layer/inline-layer/iframe-positioning",["jira/ajs/layer/inline-layer/standard-positioning","jira/util/navigator","jquery"],function(StandardPositioning,Navigator,jQuery){var IframePositioning=StandardPositioning.extend({offset:function(){var window=IframePositioning.window();var topWindow=IframePositioning.topWindow();var $iframe=jQuery("iframe",topWindow.document.body).filter(function(){return this.getAttribute("name")===window.name});var iframeOffset=$iframe.parent().offset();var offsetInDocument=this._super();var topDocumentScrollTop=this._topDocumentScrollTop();var topDocumentScrollLeft=this._topDocumentScrollLeft();var iframeScrollTop=this._iframeScrollTop();var iframeScrollLeft=this._iframeScrollLeft();var scrollTopModifier=topDocumentScrollTop-iframeScrollTop;var scrollLeftModifier=topDocumentScrollLeft-iframeScrollLeft;return{left:iframeOffset.left+offsetInDocument.left+scrollLeftModifier,top:iframeOffset.top+offsetInDocument.top+scrollTopModifier}},_topDocumentScrollTop:function(){return this.isOffsetIncludingScroll()?0:Math.max(window.top.document.body.scrollTop,window.top.document.documentElement.scrollTop)},_topDocumentScrollLeft:function(){return this.isOffsetIncludingScroll()?0:Math.max(window.top.document.body.scrollLeft,window.top.document.documentElement.scrollLeft)},_iframeScrollTop:function(){return this.isOffsetIncludingScroll()?2*Math.max(window.document.body.scrollTop,window.document.documentElement.scrollTop):0},_iframeScrollLeft:function(){return this.isOffsetIncludingScroll()?2*Math.max(window.document.body.scrollLeft,window.document.documentElement.scrollLeft):0},isOffsetIncludingScroll:function(offsetIncludingScroll){if(typeof this.offsetIncludingScroll==="undefined"){this.offsetIncludingScroll=true}if(typeof offsetIncludingScroll!=="undefined"){this.offsetIncludingScroll=offsetIncludingScroll}return this.offsetIncludingScroll},appendToBody:function(){window.top.jQuery("body").append(this.layer())},window:function(){return window.top},scrollTo:function(){}});if(Navigator.isWebkit()){IframePositioning=IframePositioning.extend({appendToBody:function(){var oldLayer=this.layer();this.layer(this._rebuildLayerInParent());window.top.jQuery("body").append(this.layer());oldLayer.remove();this.rebuilt()},appendToPlaceholder:function(){var oldLayer=this.layer();this.layer(this._rebuildLayerInIframe());this.layer().appendTo(this.placeholder());oldLayer.remove();this.rebuilt()},_rebuildLayerInParent:function(){return window.top.jQuery("<div class='ajs-layer'>"+this.layer().html()+"</div>")},_rebuildLayerInIframe:function(){return jQuery("<div class='ajs-layer'>"+this.layer().html()+"</div>")}})}if(Navigator.isMozilla()){IframePositioning=IframePositioning.extend({appendToPlaceholder:function(){var $oldLayer=this.layer();this.layer($oldLayer.clone(true).appendTo(this.placeholder()));this.rebuilt();window.setTimeout(function(){$oldLayer.remove()},10)}})}IframePositioning.window=function(){return window};IframePositioning.topWindow=function(){return window.top};return IframePositioning});